<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - BookLend</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/admin.css">
</head>
<body class="admin-body">
    <!-- Admin Header -->
    <header class="admin-header">
        <div class="admin-nav">
            <div class="nav-brand">
                <i class="fas fa-book"></i>
                <span>BookLend Admin</span>
            </div>
            <div class="admin-user">
                <span id="adminUserName">Admin</span>
                <div class="dropdown">
                    <button class="dropdown-btn"><i class="fas fa-user-circle"></i></button>
                    <div class="dropdown-content">
                        <a href="index.html">Về trang chủ</a>
                        <a href="#" onclick="logout()">Đăng xuất</a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="admin-sidebar">
            <nav class="sidebar-nav">
                <ul>
                    <li class="nav-item active" data-section="dashboard">
                        <a href="#"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
                    </li>
                    <li class="nav-item" data-section="books">
                        <a href="#"><i class="fas fa-book"></i> Quản lý sách</a>
                    </li>
                    <li class="nav-item" data-section="users">
                        <a href="#"><i class="fas fa-users"></i> Quản lý người dùng</a>
                    </li>
                    <li class="nav-item" data-section="borrowings">
                        <a href="#"><i class="fas fa-exchange-alt"></i> Mượn trả sách</a>
                    </li>
                    <li class="nav-item" data-section="reports">
                        <a href="#"><i class="fas fa-chart-bar"></i> Báo cáo</a>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="admin-main">
            <!-- Dashboard Section -->
            <section class="admin-section active" id="dashboard">
                <div class="section-header">
                    <h1>Dashboard</h1>
                    <p>Tổng quan hệ thống</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-book"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="totalBooks">0</h3>
                            <p>Tổng số sách</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="totalUsers">0</h3>
                            <p>Người dùng</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-book-reader"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="activeBorrowings">0</h3>
                            <p>Đang mượn</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="todayReturns">0</h3>
                            <p>Trả hôm nay</p>
                        </div>
                    </div>
                </div>

                <div class="dashboard-charts">
                    <div class="chart-container">
                        <h3>Thống kê mượn trả theo tháng</h3>
                        <canvas id="borrowingChart"></canvas>
                    </div>
                    <div class="recent-activities">
                        <h3>Hoạt động gần đây</h3>
                        <div class="activity-list" id="recentActivities">
                            <!-- Activities will be loaded here -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Books Management Section -->
            <section class="admin-section" id="books">
                <div class="section-header">
                    <h1>Quản lý sách</h1>
                    <button class="btn btn-primary" onclick="showAddBookModal()">
                        <i class="fas fa-plus"></i> Thêm sách mới
                    </button>
                </div>

                <div class="table-controls">
                    <div class="search-box">
                        <input type="text" placeholder="Tìm kiếm sách..." id="bookSearchInput">
                        <button class="btn btn-outline" onclick="searchBooksAdmin()">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    <div class="filter-controls">
                        <select id="categoryFilter">
                            <option value="">Tất cả thể loại</option>
                            <!-- <option value="fiction">Tiểu thuyết</option>
                            <option value="science">Khoa học</option>
                            <option value="technology">Công nghệ</option>
                            <option value="history">Lịch sử</option> -->
                        </select>
                        <select id="statusFilter">
                            <option value="">Tất cả trạng thái</option>
                            <option value="available">Có sẵn</option>
                            <option value="borrowed">Đã mượn</option>
                            <!-- <option value="maintenance">Bảo trì</option> -->
                        </select>
                    </div>
                </div>

                <div class="table-container">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>Hình ảnh</th>
                                <th>Tên sách</th>
                                <th>Thể loại</th>
                                <th>Tác giả</th>
                                <th>ISBN</th>
                                <th>Trạng thái</th>
                                <th>Số lượng</th>
                                <th>Giá</th>
                                <th>Thao tác</th>
                            </tr>
                        </thead>
                        <tbody id="booksTableBody">
                            <!-- Books data will be loaded here -->
                        </tbody>
                    </table>
                </div>

                <div class="pagination" id="booksPagination">
                    <!-- Pagination will be generated here -->
                </div>
            </section>

            <!-- Users Management Section -->
            <section class="admin-section" id="users">
                <div class="section-header">
                    <h1>Quản lý người dùng</h1>
                </div>

                <div class="table-controls">
                    <div class="search-box">
                        <input type="text" placeholder="Tìm kiếm người dùng..." id="userSearchInput">
                        <button class="btn btn-outline" onclick="searchUsersAdmin()">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>

                <div class="table-container">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Họ tên</th>
                                <th>Email</th>
                                <th>Ngày đăng ký</th>
                                <th>Số sách đang mượn</th>
                                <th>Trạng thái</th>
                                <th>Thao tác</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <!-- Users data will be loaded here -->
                        </tbody>
                    </table>
                </div>

                <div class="pagination" id="usersPagination">
                    <!-- Pagination will be generated here -->
                </div>
            </section>

            <!-- Borrowings Management Section -->
            <section class="admin-section" id="borrowings">
                <div class="section-header">
                    <h1>Quản lý mượn trả</h1>
                </div>

                <div class="table-controls">
                    <div class="search-box">
                        <input type="text" placeholder="Tìm kiếm theo tên hoặc email..." id="borrowingSearchInput">
                        <button class="btn btn-outline" onclick="searchBorrowingsAdmin()">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    <div class="filter-controls">
                        <select id="borrowingStatusFilter">
                            <option value="">Tất cả trạng thái</option>
                            <option value="active">Đang mượn</option>
                            <option value="returned">Đã trả</option>
                            <option value="overdue">Quá hạn</option>
                        </select>
                    </div>
                </div>

                <div class="table-container">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Người mượn</th>
                                <th>Sách</th>
                                <th>Ngày mượn</th>
                                <th>Ngày trả dự kiến</th>
                                <th>Ngày trả thực tế</th>
                                <th>Trạng thái</th>
                                <th>Thao tác</th>
                            </tr>
                        </thead>
                        <tbody id="borrowingsTableBody">
                            <!-- Borrowings data will be loaded here -->
                        </tbody>
                    </table>
                </div>

                <div class="pagination" id="borrowingsPagination">
                    <!-- Pagination will be generated here -->
                </div>
            </section>

            <!-- Reports Section -->
            <section class="admin-section" id="reports">
                <div class="section-header">
                    <h1>Báo cáo thống kê</h1>
                </div>

                <div class="report-filters">
                    <div class="filter-group">
                        <label>Từ ngày:</label>
                        <input type="date" id="fromDate">
                    </div>
                    <div class="filter-group">
                        <label>Đến ngày:</label>
                        <input type="date" id="toDate">
                    </div>
                    <button class="btn btn-primary" onclick="generateReport()">
                        <i class="fas fa-chart-line"></i> Tạo báo cáo
                    </button>
                    <button class="btn btn-outline" onclick="exportReport()">
                        <i class="fas fa-download"></i> Xuất Excel
                    </button>
                </div>

                <div class="reports-grid">
                    <div class="report-card">
                        <h3>Sách phổ biến nhất</h3>
                        <div class="report-content" id="popularBooks">
                            <!-- Popular books will be loaded here -->
                        </div>
                    </div>
                    <div class="report-card">
                        <h3>Người dùng tích cực</h3>
                        <div class="report-content" id="activeUsers">
                            <!-- Active users will be loaded here -->
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Add/Edit Book Modal -->
    <div class="modal" id="bookFormModal">
        <div class="modal-content modal-large">
            <span class="close" onclick="closeModal('bookFormModal')">&times;</span>
            <h2 id="bookFormTitle">Thêm sách mới</h2>
            <form id="bookForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="bookTitle">Tên sách <span class="required">*</span></label>
                        <input type="text" id="bookTitle" required>
                    </div>
                    <div class="form-group">
                        <label>Tác giả <span class="required">*</span></label>
                        <input type="text" id="bookAuthor" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>ISBN</label>
                        <input type="text" id="bookISBN">
                    </div>
                    <div class="form-group">
                        <label>Thể loại <span class="required">*</span></label>
                        <select id="bookCategory" required>
                            <option value="">Chọn thể loại</option>
                            <!-- <option value="fiction">Tiểu thuyết</option>
                            <option value="science">Khoa học</option>
                            <option value="technology">Công nghệ</option>
                            <option value="history">Lịch sử</option> -->
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <!-- <div class="form-group">
                        <label>Năm xuất bản</label>
                        <input type="number" id="bookYear" min="1900" max="2025" placeholder="VD: 2024">
                    </div> -->
                    <div class="form-group">
                        <label>Số lượng <span class="required">*</span></label>
                        <input type="number" id="bookQuantity" min="1" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Giá <span class="required">*</span></label>
                        <input type="number" id="bookPrice" min="0" step="1000" placeholder="VND" required>
                    </div>
                    <div class="form-group">
                        <label>URL hình ảnh</label>
                        <input type="url" id="bookImage">
                    </div>
                </div>
                <!-- <div class="form-group">
                    <label>Mô tả</label>
                    <textarea id="bookDescription" rows="4"></textarea>
                </div> -->
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" onclick="closeModal('bookFormModal')">Hủy</button>
                    <button type="submit" class="btn btn-primary">Lưu</button>
                </div>
            </form>
        </div>    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="js/api.js"></script>
    <script src="js/admin.js"></script>
</body>
</html>
